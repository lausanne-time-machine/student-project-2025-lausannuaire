---
theme: dashboard
title: Lausanne dashboard
toc: false
---

# Moyenne des catégories de métiers par année

```js
const demographicData = [
    {
        "year": "1885",
        "values": [
            0.0230951716,
            0.0012326728,
            0.0465857289,
            0.0267466741,
            0.0480277235,
            0.0149944181,
            0.0103474742,
            0.0713415201,
            0.0008140292,
            0.0017513257,
            0.0149771407,
            0.0002790957,
            0.003497003,
            0.0658549633,
            0.0092706298,
            0.0003488697,
            0.0126290818,
            0.0000697739,
            0.0099776723,
            0.0141165956,
            0.0135245139,
            0.0009419481,
            0.0162247651,
            0.0325322621,
            0.0009559029,
            0.0005349335,
            0.0003488697,
            0.0003721276,
            0.0077076937,
            0.0221788073,
            0.000046516,
            0.0266828808,
            0.0054191088,
            0.0094659968,
            0.0159526468,
            0.0018141222,
            0.0006977393,
            0.0080240022,
            0.0004419016,
            0.0018955252,
            0.013064006,
            0.0023955717,
            0.0002674667,
            0.0027690283,
            0.0193961565,
            0.0381430831,
            0.1310587031,
            null
        ]
    },
    {
        "year": "1901",
        "values": [
            0.0165314097,
            0.0003005711,
            0.020488929,
            0.0268176201,
            0.0611662158,
            0.005041245,
            0.003565107,
            0.0236950205,
            0.0010019036,
            0.0003823932,
            0.0021741308,
            0.0000500952,
            0.0028888221,
            0.0445680126,
            0.0066493003,
            0.000551047,
            null,
            0.0,
            0.0110209398,
            0.0138579969,
            0.0125404936,
            0.0008766657,
            0.0207343954,
            0.0688174198,
            0.0010302909,
            0.0004842534,
            0.0001502855,
            0.0002504759,
            0.0108873526,
            0.0401846842,
            0.0004759042,
            0.0220869652,
            0.007764753,
            0.0098186554,
            0.009334402,
            0.0022375847,
            0.0003506663,
            0.0113215109,
            0.0002003807,
            0.0047423438,
            0.0148615703,
            0.0108038607,
            0.0001669839,
            0.0037270815,
            0.0202200848,
            0.0381641786,
            0.0034565675,
            0.0418962696
        ]
    },
    {
        "year": "1923",
        "values": [
            0.0281533575,
            0.0014065336,
            0.0124243799,
            0.0231359649,
            0.0282667877,
            0.0042653509,
            0.0034785239,
            0.0445780399,
            0.0027828191,
            0.0006968391,
            0.0042596794,
            0,
            0.0135700242,
            0.0292184664,
            0.0057985481,
            0.0005709316,
            null,
            0,
            0.0045372051,
            0.002274274,
            0.0051788415,
            0.0024349667,
            0.0027283727,
            0.0075325166,
            0.0033968542,
            0.0036864791,
            0.0001172111,
            0.0001890502,
            0.0047202057,
            0.0035367514,
            0.0000718391,
            0.0259361766,
            0.0042196007,
            0.0072292801,
            0.0021302178,
            0.0013800665,
            0.0003251664,
            0.0339246824,
            0.0000983061,
            0.0043092105,
            0.005327435,
            0.0042649728,
            0.0012832728,
            0.0041844374,
            0.0052907592,
            0.0135208711,
            0.0004537205,
            0.0938142771
        ]
    },
    {
        "year": "1951",
        "values": [
            0.0158370158,
            0.0057065933,
            0.0247675905,
            0.0255660258,
            0.0314252826,
            0.0037151386,
            0.003983885,
            0.0378400788,
            0.0010242603,
            0.0007316145,
            0.0097660784,
            0.0000097549,
            0.004642338,
            0.0170485694,
            0.003960961,
            0.0017875782,
            null,
            0.0001170583,
            0.0039068216,
            0.0108615493,
            0.007978988,
            0.0027459932,
            0.0187737165,
            0.0397027694,
            0.002376284,
            0.001639792,
            0.0003877557,
            0.0000585292,
            0.0072371309,
            0.0100289719,
            0.0002204598,
            0.0326968287,
            0.0100962805,
            0.0200511155,
            0.0056544048,
            0.0031391141,
            0.0004779882,
            0.0126227893,
            0.000317033,
            0.0070244749,
            0.0376084009,
            0.0026996576,
            0.0023811614,
            0.003002546,
            0.019055632,
            0.0279379201,
            0.0115887741,
            0.0700530664
        ]
    }
]

const groups = [
    "liberal_professions_law",
    "associations_unions",
    "liberal_professions_finance",
    "local_commerce_groceries",
    "hospitality_lodging",
    "raw_material_production",
    "livestock",
    "transport_professions",
    "sharpening_service",
    "raw_material_sales",
    "fine_articles",
    "bathing_establishments",
    "luxury_items",
    "garment_supplies",
    "book_art_supply",
    "science_articles",
    "beer_producer_seller",
    "containers",
    "laundry",
    "raw_material_building",
    "fabric_supply",
    "lighting",
    "construction_sites",
    "liberal_professions_construction",
    "entertainment_articles",
    "processing_articles",
    "antiquarians",
    "non_prestigious_garment",
    "raw_material_agriculture",
    "household_items",
    "products_boats_home",
    "liberal_professions_art",
    "personal_care",
    "medical_products",
    "agricultural_products",
    "liberal_professions_engraving",
    "local_commerce_groceries_soap",
    "postal_delivery",
    "children_entertainment",
    "tooling",
    "liberal_professions_retail",
    "food_processing",
    "recreational_leisure",
    "craft_processing",
    "construction_products",
    "education_professions",
    "widow",
    "alcool_producer_seller"
];

const demographics = demographicData.flatMap(d => {
    const total = d.values.reduce((a, b) => a + b, 0);
    return d.values.map((count, i) => ({
        year: d.year,
        group: groups[i],
        percent: count / total
    }));
});

````


```js
const categoryColors = {
  liberal_professions_law: "#FF9999",
  liberal_professions_finance: "#FF8080",
  liberal_professions_construction: "#FF6666",
  liberal_professions_art: "#FF4D4D",
  liberal_professions_engraving: "#FF3333",
  liberal_professions_retail: "#FF1A1A",
  associations_unions: "#FFA07A",
  local_commerce_groceries: "#99CCFF",
  local_commerce_groceries_soap: "#80BFFF",
  fine_articles: "#66B2FF",
  luxury_items: "#4DA6FF",
  garment_supplies: "#3399FF",
  book_art_supply: "#1A8CFF",
  science_articles: "#007FFF",
  antiquarians: "#0066CC",
  hospitality_lodging: "#FFD700",
  bathing_establishments: "#FFC700",
  raw_material_production: "#90EE90",
  raw_material_sales: "#77DD77",
  raw_material_building: "#66CC66",
  raw_material_agriculture: "#55BB55",
  food_processing: "#44AA44",
  craft_processing: "#339933",
  construction_products: "#228822",
  processing_articles: "#117711",
  livestock: "#CCFFCC",
  agricultural_products: "#BBFFBB",
  transport_professions: "#CCCCFF",
  postal_delivery: "#B3B3FF",
  containers: "#9999FF",
  sharpening_service: "#FFB6C1",
  tooling: "#FF99CC",
  personal_care: "#FF80BF",
  laundry: "#FF66B2",
  entertainment_articles: "#DDA0DD",
  recreational_leisure: "#CC99FF",
  children_entertainment: "#BB88FF",
  non_prestigious_garment: "#D3D3D3",
  household_items: "#C0C0C0",
  products_boats_home: "#A9A9A9",
  medical_products: "#999999",
  education_professions: "#808080",
  widow: "#696969",
  other: "#555555"
};

function stackedChart(data, {width} = {}) {
  return Plot.plot({
    title: "Proportions of Categories by Year",
    width,
    height: 800,
    x: {label: "Year", type: "band"},
    y: {label: "Percentage", percent: true},
    color: {
      legend: true,
      domain: Object.keys(categoryColors),
      range: Object.values(categoryColors),
      type: "ordinal"
    },
    marks: [
      Plot.barY(data, Plot.stackY({x: "year", y: "percent", fill: "group", tip: true})),
      Plot.ruleY([0])
    ]
  });
}
```


<div class="grid grid-cols-1"> <div class="card">${resize(width => stackedChart(demographics, {width}))}</div> </div>
